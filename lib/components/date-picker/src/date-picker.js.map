{"version":3,"file":"date-picker.js","sources":["../../../../../../packages/components/date-picker/src/date-picker.tsx"],"sourcesContent":["import { computed, defineComponent, provide, reactive, ref, toRef } from 'vue'\nimport dayjs from 'dayjs'\nimport customParseFormat from 'dayjs/plugin/customParseFormat.js'\nimport advancedFormat from 'dayjs/plugin/advancedFormat.js'\nimport localeData from 'dayjs/plugin/localeData.js'\nimport weekOfYear from 'dayjs/plugin/weekOfYear.js'\nimport weekYear from 'dayjs/plugin/weekYear.js'\nimport dayOfYear from 'dayjs/plugin/dayOfYear.js'\nimport isSameOrAfter from 'dayjs/plugin/isSameOrAfter.js'\nimport isSameOrBefore from 'dayjs/plugin/isSameOrBefore.js'\nimport { ElRadioButton, ElRadioGroup } from '@element-plus/components/radio'\nimport { useNamespace } from '@element-plus/hooks'\nimport {\n  CommonPicker,\n  DEFAULT_FORMATS_DATE,\n  DEFAULT_FORMATS_DATEPICKER,\n  type DateModelType,\n  PICKER_POPPER_OPTIONS_INJECTION_KEY,\n  type SingleOrRange,\n} from '@element-plus/components/time-picker'\nimport { UPDATE_MODEL_EVENT } from '@element-plus/constants'\nimport {\n  ROOT_PICKER_INJECTION_KEY,\n  ROOT_PICKER_IS_DEFAULT_FORMAT_INJECTION_KEY,\n} from './constants'\nimport { SelectTypeKey, datePickerProps } from './props/date-picker'\nimport { getPanel } from './panel-utils'\n\nimport type { Dayjs } from 'dayjs'\nimport type { DatePickerExpose } from './instance'\n\ndayjs.extend(localeData)\ndayjs.extend(advancedFormat)\ndayjs.extend(customParseFormat)\ndayjs.extend(weekOfYear)\ndayjs.extend(weekYear)\ndayjs.extend(dayOfYear)\ndayjs.extend(isSameOrAfter)\ndayjs.extend(isSameOrBefore)\n\nexport default defineComponent({\n  name: 'ElDatePicker',\n  install: null,\n  props: datePickerProps,\n  emits: [UPDATE_MODEL_EVENT],\n  setup(props, { expose, emit, slots }) {\n    const ns = useNamespace('picker-panel')\n    const isDefaultFormat = computed(() => {\n      return !props.format\n    })\n    provide(ROOT_PICKER_IS_DEFAULT_FORMAT_INJECTION_KEY, isDefaultFormat)\n    provide(\n      PICKER_POPPER_OPTIONS_INJECTION_KEY,\n      reactive(toRef(props, 'popperOptions'))\n    )\n    provide(ROOT_PICKER_INJECTION_KEY, {\n      slots,\n      pickerNs: ns,\n    })\n    const selectType = ref<SelectTypeKey | undefined>(\n      props.typeList.length ? props.typeList[0].key : undefined\n    )\n\n    const handleRadioChange = (value: any) => {\n      selectType.value = value\n    }\n    const commonPicker = ref<InstanceType<typeof CommonPicker>>()\n    const selectingDate = ref()\n    const refProps: DatePickerExpose = {\n      selectType,\n      focus: () => {\n        commonPicker.value?.focus()\n      },\n      blur: () => {\n        commonPicker.value?.blur()\n      },\n      handleOpen: () => {\n        commonPicker.value?.handleOpen()\n      },\n      handleClose: () => {\n        commonPicker.value?.handleClose()\n      },\n      selectingDate,\n    }\n    const getSelectingDate = (val: {\n      minDate: Dayjs\n      maxDate: Dayjs | null\n    }) => {\n      selectingDate.value = val\n    }\n\n    provide('getSelectingDate', {\n      getSelectingDate,\n    })\n    expose(refProps)\n\n    const onModelValueUpdated = (val: SingleOrRange<DateModelType> | null) => {\n      emit(UPDATE_MODEL_EVENT, val)\n    }\n\n    const componentType = computed(() => {\n      return selectType.value || props.type\n    })\n\n    return () => {\n      // since props always have all defined keys on it, {format, ...props} will always overwrite format\n      // pick props.format or provide default value here before spreading\n      const format =\n        props.format ??\n        (DEFAULT_FORMATS_DATEPICKER[componentType.value] ||\n          DEFAULT_FORMATS_DATE)\n\n      const Component = getPanel(componentType.value)\n\n      return (\n        <CommonPicker\n          {...props}\n          format={format}\n          type={componentType.value}\n          ref={commonPicker}\n          onUpdate:modelValue={onModelValueUpdated}\n        >\n          {{\n            default: (scopedProps: /**FIXME: remove any type */ any) => (\n              <>\n                {props.typeList?.length > 0 && (\n                  <ElRadioGroup\n                    modelValue={selectType.value}\n                    onChange={handleRadioChange}\n                    size=\"small\"\n                  >\n                    {props.typeList.map((item) => (\n                      <ElRadioButton\n                        key={item.key}\n                        value={item.key}\n                        label={item.label}\n                        class={{ 'is-active': selectType.value === item.key }}\n                      />\n                    ))}\n                  </ElRadioGroup>\n                )}\n                <Component {...scopedProps}>\n                  {{\n                    'prev-month': slots['prev-month'],\n                    'next-month': slots['next-month'],\n                    'prev-year': slots['prev-year'],\n                    'next-year': slots['next-year'],\n                  }}\n                </Component>\n              </>\n            ),\n            'range-separator': slots['range-separator'],\n            open: slots['open'],\n          }}\n        </CommonPicker>\n      )\n    }\n  },\n})\n"],"names":["dayjs","extend","localeData","advancedFormat","customParseFormat","weekOfYear","weekYear","dayOfYear","defineComponent","name","datePickerProps","install","props","UPDATE_MODEL_EVENT","emit","useNamespace","slots","provide","ROOT_PICKER_IS_DEFAULT_FORMAT_INJECTION_KEY","PICKER_POPPER_OPTIONS_INJECTION_KEY","reactive","toRef","ROOT_PICKER_INJECTION_KEY","ref","pickerNs","ns","handleRadioChange","value","commonPicker","selectingDate","selectType","focus","blur","handleOpen","handleClose","getSelectingDate","onModelValueUpdated","val","DEFAULT_FORMATS_DATEPICKER","DEFAULT_FORMATS_DATE","_createVNode","CommonPicker","_mergeProps","format","componentType","_Fragment","ElRadioGroup","default","ElRadioButton","item","label"],"mappings":"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"}